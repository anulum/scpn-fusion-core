=== SCPN Fusion Core — Neural Transport Training (QLKNN-10D) ===
Data:    data/qlknn10d_processed
Output:  weights/neural_transport_qlknn.npz
Arch:    auto -> 256 -> 128 -> 3
Epochs:  1000
LR:      0.0003
Batch:   8192

Data is GB-normalized (raw gyro-Bohm fluxes, no chi_gb multiplication)
Added derived features: ITG excess, TEM excess -> 12D input

Data loaded: train=(1801197, 12), val=(100066, 12), test=(100068, 12)
Y ranges: chi_e=[0.00, 498.56], chi_i=[0.00, 1006.12], D_e=[0.00, 80.36]

Training on GB-normalized targets (loss in GB space, eval in physical space)
Y train ranges: [0.000, 498.563], [0.000, 1006.115], [0.000, 80.355]

--- Training ---
JAX backend: GPU (cuda:0)
  Output scale (P90): [43.07545204 72.60898666  7.2507782 ]
  Output bias init: flux=[-1.85671903 -2.03404507 -2.41275783], gate=-0.42 (flux fraction=0.40, target mean: [6.25133028 8.92582728 0.62198069])
  Epoch    0/1000 | train_loss=983.2079 | val_loss=608.6352 | rel_l2=0.8939 | best=0.8939 | lr=3.00e-05 | pat=0/150 | 7s
  Epoch    1/1000 | train_loss=499.2271 | val_loss=412.3793 | rel_l2=0.7482 | best=0.7482 | lr=6.00e-05 | pat=0/150 | 9s
  Epoch    2/1000 | train_loss=395.5128 | val_loss=347.2180 | rel_l2=0.6378 | best=0.6378 | lr=9.00e-05 | pat=0/150 | 11s
  Epoch    3/1000 | train_loss=344.0981 | val_loss=306.2390 | rel_l2=0.5630 | best=0.5630 | lr=1.20e-04 | pat=0/150 | 13s
  Epoch    4/1000 | train_loss=310.4515 | val_loss=280.3740 | rel_l2=0.5147 | best=0.5147 | lr=1.50e-04 | pat=0/150 | 15s
  Epoch    5/1000 | train_loss=288.8443 | val_loss=265.5254 | rel_l2=0.4873 | best=0.4873 | lr=1.80e-04 | pat=0/150 | 17s
  Epoch    6/1000 | train_loss=272.6010 | val_loss=251.8514 | rel_l2=0.4666 | best=0.4666 | lr=2.10e-04 | pat=0/150 | 19s
  Epoch    7/1000 | train_loss=258.8799 | val_loss=236.3593 | rel_l2=0.4485 | best=0.4485 | lr=2.40e-04 | pat=0/150 | 21s
  Epoch    8/1000 | train_loss=245.5134 | val_loss=224.1484 | rel_l2=0.4351 | best=0.4351 | lr=2.70e-04 | pat=0/150 | 24s
  Epoch    9/1000 | train_loss=231.6144 | val_loss=210.8419 | rel_l2=0.4234 | best=0.4234 | lr=3.00e-04 | pat=0/150 | 26s
  Epoch   10/1000 | train_loss=217.9352 | val_loss=203.3428 | rel_l2=0.4098 | best=0.4098 | lr=3.00e-04 | pat=0/150 | 28s
  Epoch   11/1000 | train_loss=205.8832 | val_loss=187.1551 | rel_l2=0.3954 | best=0.3954 | lr=3.00e-04 | pat=0/150 | 30s
  Epoch   12/1000 | train_loss=195.1274 | val_loss=179.9551 | rel_l2=0.3925 | best=0.3925 | lr=3.00e-04 | pat=0/150 | 32s
  Epoch   13/1000 | train_loss=187.2896 | val_loss=173.8380 | rel_l2=0.3853 | best=0.3853 | lr=3.00e-04 | pat=0/150 | 34s
  Epoch   14/1000 | train_loss=180.2988 | val_loss=166.7193 | rel_l2=0.3744 | best=0.3744 | lr=3.00e-04 | pat=0/150 | 36s
  Epoch   15/1000 | train_loss=175.0819 | val_loss=165.9560 | rel_l2=0.3684 | best=0.3684 | lr=3.00e-04 | pat=0/150 | 38s
  Epoch   16/1000 | train_loss=170.4323 | val_loss=158.5268 | rel_l2=0.3631 | best=0.3631 | lr=3.00e-04 | pat=0/150 | 40s
  Epoch   17/1000 | train_loss=166.2821 | val_loss=158.5540 | rel_l2=0.3610 | best=0.3610 | lr=3.00e-04 | pat=0/150 | 42s
  Epoch   18/1000 | train_loss=162.6938 | val_loss=152.3267 | rel_l2=0.3575 | best=0.3575 | lr=3.00e-04 | pat=0/150 | 44s
  Epoch   19/1000 | train_loss=159.7825 | val_loss=151.5781 | rel_l2=0.3566 | best=0.3566 | lr=3.00e-04 | pat=0/150 | 46s
  Epoch   20/1000 | train_loss=157.0587 | val_loss=148.9711 | rel_l2=0.3510 | best=0.3510 | lr=3.00e-04 | pat=0/150 | 48s
  Epoch   21/1000 | train_loss=154.4380 | val_loss=146.8902 | rel_l2=0.3502 | best=0.3502 | lr=3.00e-04 | pat=0/150 | 51s
  Epoch   22/1000 | train_loss=152.2256 | val_loss=145.0219 | rel_l2=0.3444 | best=0.3444 | lr=3.00e-04 | pat=0/150 | 53s
  Epoch   23/1000 | train_loss=150.1364 | val_loss=145.3464 | rel_l2=0.3437 | best=0.3437 | lr=3.00e-04 | pat=0/150 | 55s
  Epoch   24/1000 | train_loss=148.7579 | val_loss=144.1700 | rel_l2=0.3505 | best=0.3437 | lr=3.00e-04 | pat=1/150 | 57s
  Epoch   25/1000 | train_loss=146.8615 | val_loss=141.9850 | rel_l2=0.3412 | best=0.3412 | lr=3.00e-04 | pat=0/150 | 59s
  Epoch   26/1000 | train_loss=145.6373 | val_loss=139.3909 | rel_l2=0.3395 | best=0.3395 | lr=3.00e-04 | pat=0/150 | 61s
  Epoch   27/1000 | train_loss=144.3675 | val_loss=141.4004 | rel_l2=0.3508 | best=0.3395 | lr=3.00e-04 | pat=1/150 | 63s
  Epoch   28/1000 | train_loss=143.3611 | val_loss=139.0638 | rel_l2=0.3404 | best=0.3395 | lr=3.00e-04 | pat=2/150 | 65s
  Epoch   29/1000 | train_loss=142.0144 | val_loss=137.9161 | rel_l2=0.3374 | best=0.3374 | lr=3.00e-04 | pat=0/150 | 67s
  Epoch   30/1000 | train_loss=141.4736 | val_loss=137.8124 | rel_l2=0.3374 | best=0.3374 | lr=3.00e-04 | pat=0/150 | 69s
  Epoch   31/1000 | train_loss=140.0518 | val_loss=136.0369 | rel_l2=0.3399 | best=0.3374 | lr=3.00e-04 | pat=1/150 | 71s
  Epoch   32/1000 | train_loss=139.5845 | val_loss=135.6315 | rel_l2=0.3444 | best=0.3374 | lr=3.00e-04 | pat=2/150 | 73s
  Epoch   33/1000 | train_loss=138.3272 | val_loss=134.6668 | rel_l2=0.3336 | best=0.3336 | lr=3.00e-04 | pat=0/150 | 75s
  Epoch   34/1000 | train_loss=137.7692 | val_loss=135.4272 | rel_l2=0.3385 | best=0.3336 | lr=3.00e-04 | pat=1/150 | 77s
  Epoch   35/1000 | train_loss=137.0716 | val_loss=134.4285 | rel_l2=0.3382 | best=0.3336 | lr=3.00e-04 | pat=2/150 | 79s
  Epoch   36/1000 | train_loss=136.2393 | val_loss=133.4188 | rel_l2=0.3321 | best=0.3321 | lr=2.99e-04 | pat=0/150 | 81s
  Epoch   37/1000 | train_loss=135.7167 | val_loss=133.2838 | rel_l2=0.3316 | best=0.3316 | lr=2.99e-04 | pat=0/150 | 83s
  Epoch   38/1000 | train_loss=135.2690 | val_loss=132.1377 | rel_l2=0.3276 | best=0.3276 | lr=2.99e-04 | pat=0/150 | 85s
  Epoch   39/1000 | train_loss=134.7017 | val_loss=130.6753 | rel_l2=0.3278 | best=0.3276 | lr=2.99e-04 | pat=1/150 | 87s
  Epoch   40/1000 | train_loss=133.9980 | val_loss=131.4097 | rel_l2=0.3323 | best=0.3276 | lr=2.99e-04 | pat=2/150 | 89s
  Epoch   41/1000 | train_loss=133.5302 | val_loss=132.1623 | rel_l2=0.3331 | best=0.3276 | lr=2.99e-04 | pat=3/150 | 91s
  Epoch   42/1000 | train_loss=133.2179 | val_loss=133.9889 | rel_l2=0.3280 | best=0.3276 | lr=2.99e-04 | pat=4/150 | 93s
  Epoch   43/1000 | train_loss=132.7299 | val_loss=131.9309 | rel_l2=0.3323 | best=0.3276 | lr=2.99e-04 | pat=5/150 | 95s
  Epoch   44/1000 | train_loss=131.9547 | val_loss=129.9461 | rel_l2=0.3241 | best=0.3241 | lr=2.99e-04 | pat=0/150 | 97s
  Epoch   45/1000 | train_loss=131.8145 | val_loss=130.3725 | rel_l2=0.3296 | best=0.3241 | lr=2.99e-04 | pat=1/150 | 99s
  Epoch   46/1000 | train_loss=131.3141 | val_loss=130.5645 | rel_l2=0.3275 | best=0.3241 | lr=2.99e-04 | pat=2/150 | 101s
  Epoch   47/1000 | train_loss=130.7855 | val_loss=128.5148 | rel_l2=0.3267 | best=0.3241 | lr=2.99e-04 | pat=3/150 | 103s
  Epoch   48/1000 | train_loss=130.9508 | val_loss=131.0693 | rel_l2=0.3391 | best=0.3241 | lr=2.99e-04 | pat=4/150 | 105s
  Epoch   49/1000 | train_loss=130.4257 | val_loss=127.4095 | rel_l2=0.3241 | best=0.3241 | lr=2.99e-04 | pat=0/150 | 107s
  Epoch   50/1000 | train_loss=130.0881 | val_loss=130.2918 | rel_l2=0.3243 | best=0.3241 | lr=2.99e-04 | pat=1/150 | 109s
  Epoch   51/1000 | train_loss=129.9901 | val_loss=128.4726 | rel_l2=0.3275 | best=0.3241 | lr=2.99e-04 | pat=2/150 | 111s
  Epoch   52/1000 | train_loss=129.0739 | val_loss=129.0246 | rel_l2=0.3288 | best=0.3241 | lr=2.99e-04 | pat=3/150 | 113s
  Epoch   53/1000 | train_loss=129.1024 | val_loss=127.2345 | rel_l2=0.3256 | best=0.3241 | lr=2.99e-04 | pat=4/150 | 115s
  Epoch   54/1000 | train_loss=128.9478 | val_loss=128.8920 | rel_l2=0.3363 | best=0.3241 | lr=2.99e-04 | pat=5/150 | 117s
  Epoch   55/1000 | train_loss=128.8370 | val_loss=127.4490 | rel_l2=0.3247 | best=0.3241 | lr=2.98e-04 | pat=6/150 | 119s
  Epoch   56/1000 | train_loss=128.1240 | val_loss=127.2905 | rel_l2=0.3235 | best=0.3235 | lr=2.98e-04 | pat=0/150 | 121s
  Epoch   57/1000 | train_loss=128.0693 | val_loss=128.8437 | rel_l2=0.3310 | best=0.3235 | lr=2.98e-04 | pat=1/150 | 123s
  Epoch   58/1000 | train_loss=127.6835 | val_loss=128.1152 | rel_l2=0.3239 | best=0.3235 | lr=2.98e-04 | pat=2/150 | 125s
  Epoch   59/1000 | train_loss=127.5995 | val_loss=127.8917 | rel_l2=0.3283 | best=0.3235 | lr=2.98e-04 | pat=3/150 | 127s
  Epoch   60/1000 | train_loss=127.4490 | val_loss=126.1972 | rel_l2=0.3240 | best=0.3235 | lr=2.98e-04 | pat=4/150 | 129s
  Epoch   61/1000 | train_loss=127.1934 | val_loss=128.2116 | rel_l2=0.3226 | best=0.3226 | lr=2.98e-04 | pat=0/150 | 131s
  Epoch   62/1000 | train_loss=126.9762 | val_loss=126.2160 | rel_l2=0.3208 | best=0.3208 | lr=2.98e-04 | pat=0/150 | 133s
  Epoch   63/1000 | train_loss=126.7628 | val_loss=127.2582 | rel_l2=0.3250 | best=0.3208 | lr=2.98e-04 | pat=1/150 | 135s
  Epoch   64/1000 | train_loss=126.4158 | val_loss=125.5716 | rel_l2=0.3204 | best=0.3204 | lr=2.98e-04 | pat=0/150 | 136s
  Epoch   65/1000 | train_loss=126.4556 | val_loss=127.8167 | rel_l2=0.3280 | best=0.3204 | lr=2.98e-04 | pat=1/150 | 138s
  Epoch   66/1000 | train_loss=126.1760 | val_loss=126.7988 | rel_l2=0.3230 | best=0.3204 | lr=2.98e-04 | pat=2/150 | 140s
  Epoch   67/1000 | train_loss=126.1694 | val_loss=125.6090 | rel_l2=0.3279 | best=0.3204 | lr=2.98e-04 | pat=3/150 | 142s
  Epoch   68/1000 | train_loss=125.8405 | val_loss=125.2513 | rel_l2=0.3231 | best=0.3204 | lr=2.97e-04 | pat=4/150 | 144s
  Epoch   69/1000 | train_loss=125.5606 | val_loss=125.2847 | rel_l2=0.3219 | best=0.3204 | lr=2.97e-04 | pat=5/150 | 146s
  Epoch   70/1000 | train_loss=125.5590 | val_loss=126.2196 | rel_l2=0.3247 | best=0.3204 | lr=2.97e-04 | pat=6/150 | 149s
  Epoch   71/1000 | train_loss=125.5470 | val_loss=125.1286 | rel_l2=0.3200 | best=0.3200 | lr=2.97e-04 | pat=0/150 | 151s
  Epoch   72/1000 | train_loss=125.3546 | val_loss=125.8992 | rel_l2=0.3221 | best=0.3200 | lr=2.97e-04 | pat=1/150 | 152s
  Epoch   73/1000 | train_loss=125.3317 | val_loss=125.8504 | rel_l2=0.3291 | best=0.3200 | lr=2.97e-04 | pat=2/150 | 154s
  Epoch   74/1000 | train_loss=124.8023 | val_loss=124.5627 | rel_l2=0.3197 | best=0.3197 | lr=2.97e-04 | pat=0/150 | 156s
  Epoch   75/1000 | train_loss=124.6650 | val_loss=127.7711 | rel_l2=0.3224 | best=0.3197 | lr=2.97e-04 | pat=1/150 | 158s
  Epoch   76/1000 | train_loss=124.9238 | val_loss=125.4551 | rel_l2=0.3214 | best=0.3197 | lr=2.97e-04 | pat=2/150 | 161s
  Epoch   77/1000 | train_loss=124.5595 | val_loss=125.6463 | rel_l2=0.3206 | best=0.3197 | lr=2.97e-04 | pat=3/150 | 163s
  Epoch   78/1000 | train_loss=124.3048 | val_loss=124.3966 | rel_l2=0.3218 | best=0.3197 | lr=2.97e-04 | pat=4/150 | 165s
  Epoch   79/1000 | train_loss=124.3130 | val_loss=126.0592 | rel_l2=0.3228 | best=0.3197 | lr=2.96e-04 | pat=5/150 | 167s
  Epoch   80/1000 | train_loss=124.0158 | val_loss=126.3125 | rel_l2=0.3357 | best=0.3197 | lr=2.96e-04 | pat=6/150 | 169s
  Epoch   81/1000 | train_loss=123.6559 | val_loss=125.4594 | rel_l2=0.3267 | best=0.3197 | lr=2.96e-04 | pat=7/150 | 171s
  Epoch   82/1000 | train_loss=123.5103 | val_loss=124.6932 | rel_l2=0.3235 | best=0.3197 | lr=2.96e-04 | pat=8/150 | 173s
  Epoch   83/1000 | train_loss=123.8354 | val_loss=124.6647 | rel_l2=0.3199 | best=0.3197 | lr=2.96e-04 | pat=9/150 | 175s
  Epoch   84/1000 | train_loss=123.5825 | val_loss=124.9076 | rel_l2=0.3238 | best=0.3197 | lr=2.96e-04 | pat=10/150 | 177s
  Epoch   85/1000 | train_loss=123.5205 | val_loss=124.2865 | rel_l2=0.3241 | best=0.3197 | lr=2.96e-04 | pat=11/150 | 179s
  Epoch   86/1000 | train_loss=123.3866 | val_loss=124.5504 | rel_l2=0.3230 | best=0.3197 | lr=2.96e-04 | pat=12/150 | 181s
  Epoch   87/1000 | train_loss=123.2592 | val_loss=124.7929 | rel_l2=0.3258 | best=0.3197 | lr=2.96e-04 | pat=13/150 | 183s
  Epoch   88/1000 | train_loss=123.3733 | val_loss=125.0443 | rel_l2=0.3203 | best=0.3197 | lr=2.95e-04 | pat=14/150 | 185s
  Epoch   89/1000 | train_loss=122.9770 | val_loss=123.6166 | rel_l2=0.3268 | best=0.3197 | lr=2.95e-04 | pat=15/150 | 187s
  Epoch   90/1000 | train_loss=122.8893 | val_loss=123.4265 | rel_l2=0.3192 | best=0.3192 | lr=2.95e-04 | pat=0/150 | 189s
  Epoch   91/1000 | train_loss=122.8413 | val_loss=125.0288 | rel_l2=0.3228 | best=0.3192 | lr=2.95e-04 | pat=1/150 | 192s
  Epoch   92/1000 | train_loss=122.6355 | val_loss=124.4876 | rel_l2=0.3284 | best=0.3192 | lr=2.95e-04 | pat=2/150 | 194s
  Epoch   93/1000 | train_loss=122.4176 | val_loss=123.0509 | rel_l2=0.3234 | best=0.3192 | lr=2.95e-04 | pat=3/150 | 196s
  Epoch   94/1000 | train_loss=122.7163 | val_loss=124.0447 | rel_l2=0.3211 | best=0.3192 | lr=2.95e-04 | pat=4/150 | 198s
  Epoch   95/1000 | train_loss=122.2483 | val_loss=124.5483 | rel_l2=0.3239 | best=0.3192 | lr=2.95e-04 | pat=5/150 | 200s
  Epoch   96/1000 | train_loss=122.4822 | val_loss=126.1139 | rel_l2=0.3209 | best=0.3192 | lr=2.94e-04 | pat=6/150 | 202s
  Epoch   97/1000 | train_loss=122.1434 | val_loss=124.9554 | rel_l2=0.3298 | best=0.3192 | lr=2.94e-04 | pat=7/150 | 204s
  Epoch   98/1000 | train_loss=122.3359 | val_loss=125.4218 | rel_l2=0.3375 | best=0.3192 | lr=2.94e-04 | pat=8/150 | 206s
  Epoch   99/1000 | train_loss=121.9690 | val_loss=122.9432 | rel_l2=0.3217 | best=0.3192 | lr=2.94e-04 | pat=9/150 | 208s
  Epoch  100/1000 | train_loss=122.1235 | val_loss=126.0508 | rel_l2=0.3200 | best=0.3192 | lr=2.94e-04 | pat=10/150 | 210s
  Epoch  101/1000 | train_loss=121.9486 | val_loss=125.1390 | rel_l2=0.3264 | best=0.3192 | lr=2.94e-04 | pat=11/150 | 212s
  Epoch  102/1000 | train_loss=121.8869 | val_loss=125.0243 | rel_l2=0.3257 | best=0.3192 | lr=2.94e-04 | pat=12/150 | 214s
  Epoch  103/1000 | train_loss=121.8354 | val_loss=122.7140 | rel_l2=0.3203 | best=0.3192 | lr=2.94e-04 | pat=13/150 | 217s
  Epoch  104/1000 | train_loss=121.5105 | val_loss=122.8351 | rel_l2=0.3168 | best=0.3168 | lr=2.93e-04 | pat=0/150 | 219s
  Epoch  105/1000 | train_loss=121.6804 | val_loss=123.0846 | rel_l2=0.3212 | best=0.3168 | lr=2.93e-04 | pat=1/150 | 221s
  Epoch  106/1000 | train_loss=121.5268 | val_loss=122.5761 | rel_l2=0.3210 | best=0.3168 | lr=2.93e-04 | pat=2/150 | 223s
  Epoch  107/1000 | train_loss=121.2740 | val_loss=123.1388 | rel_l2=0.3190 | best=0.3168 | lr=2.93e-04 | pat=3/150 | 225s
  Epoch  108/1000 | train_loss=121.3514 | val_loss=123.4673 | rel_l2=0.3165 | best=0.3165 | lr=2.93e-04 | pat=0/150 | 227s
  Epoch  109/1000 | train_loss=121.2489 | val_loss=123.2493 | rel_l2=0.3259 | best=0.3165 | lr=2.93e-04 | pat=1/150 | 229s
  Epoch  110/1000 | train_loss=120.9871 | val_loss=123.1997 | rel_l2=0.3153 | best=0.3153 | lr=2.93e-04 | pat=0/150 | 231s
  Epoch  111/1000 | train_loss=121.1023 | val_loss=123.6473 | rel_l2=0.3215 | best=0.3153 | lr=2.92e-04 | pat=1/150 | 233s
  Epoch  112/1000 | train_loss=121.0451 | val_loss=124.0055 | rel_l2=0.3260 | best=0.3153 | lr=2.92e-04 | pat=2/150 | 235s
  Epoch  113/1000 | train_loss=121.2976 | val_loss=124.4562 | rel_l2=0.3214 | best=0.3153 | lr=2.92e-04 | pat=3/150 | 237s
  Epoch  114/1000 | train_loss=120.8202 | val_loss=122.6744 | rel_l2=0.3199 | best=0.3153 | lr=2.92e-04 | pat=4/150 | 239s
  Epoch  115/1000 | train_loss=120.6735 | val_loss=124.0923 | rel_l2=0.3214 | best=0.3153 | lr=2.92e-04 | pat=5/150 | 242s
  Epoch  116/1000 | train_loss=120.5433 | val_loss=125.3580 | rel_l2=0.3221 | best=0.3153 | lr=2.92e-04 | pat=6/150 | 244s
  Epoch  117/1000 | train_loss=120.6085 | val_loss=124.5749 | rel_l2=0.3185 | best=0.3153 | lr=2.91e-04 | pat=7/150 | 246s
  Epoch  118/1000 | train_loss=120.7900 | val_loss=123.3250 | rel_l2=0.3207 | best=0.3153 | lr=2.91e-04 | pat=8/150 | 248s
  Epoch  119/1000 | train_loss=120.4081 | val_loss=123.2320 | rel_l2=0.3241 | best=0.3153 | lr=2.91e-04 | pat=9/150 | 250s
  Epoch  120/1000 | train_loss=120.4841 | val_loss=124.4594 | rel_l2=0.3207 | best=0.3153 | lr=2.91e-04 | pat=10/150 | 252s
  Epoch  121/1000 | train_loss=120.3261 | val_loss=122.4415 | rel_l2=0.3191 | best=0.3153 | lr=2.91e-04 | pat=11/150 | 254s
  Epoch  122/1000 | train_loss=120.3556 | val_loss=123.5385 | rel_l2=0.3162 | best=0.3153 | lr=2.91e-04 | pat=12/150 | 256s
  Epoch  123/1000 | train_loss=120.1482 | val_loss=122.9984 | rel_l2=0.3152 | best=0.3152 | lr=2.90e-04 | pat=0/150 | 258s
  Epoch  124/1000 | train_loss=120.0655 | val_loss=123.5349 | rel_l2=0.3175 | best=0.3152 | lr=2.90e-04 | pat=1/150 | 260s
  Epoch  125/1000 | train_loss=120.1330 | val_loss=124.8941 | rel_l2=0.3249 | best=0.3152 | lr=2.90e-04 | pat=2/150 | 262s
  Epoch  126/1000 | train_loss=120.1079 | val_loss=122.2196 | rel_l2=0.3182 | best=0.3152 | lr=2.90e-04 | pat=3/150 | 264s
  Epoch  127/1000 | train_loss=120.2266 | val_loss=124.8697 | rel_l2=0.3324 | best=0.3152 | lr=2.90e-04 | pat=4/150 | 266s
  Epoch  128/1000 | train_loss=119.8031 | val_loss=123.3394 | rel_l2=0.3185 | best=0.3152 | lr=2.90e-04 | pat=5/150 | 268s
  Epoch  129/1000 | train_loss=119.8980 | val_loss=122.2631 | rel_l2=0.3185 | best=0.3152 | lr=2.89e-04 | pat=6/150 | 270s
  Epoch  130/1000 | train_loss=119.8393 | val_loss=122.3731 | rel_l2=0.3158 | best=0.3152 | lr=2.89e-04 | pat=7/150 | 273s
  Epoch  131/1000 | train_loss=119.9811 | val_loss=121.6791 | rel_l2=0.3213 | best=0.3152 | lr=2.89e-04 | pat=8/150 | 275s
  Epoch  132/1000 | train_loss=119.6174 | val_loss=122.3770 | rel_l2=0.3181 | best=0.3152 | lr=2.89e-04 | pat=9/150 | 277s
  Epoch  133/1000 | train_loss=119.5528 | val_loss=122.6823 | rel_l2=0.3183 | best=0.3152 | lr=2.89e-04 | pat=10/150 | 279s
  Epoch  134/1000 | train_loss=119.3268 | val_loss=123.5981 | rel_l2=0.3189 | best=0.3152 | lr=2.89e-04 | pat=11/150 | 281s
  Epoch  135/1000 | train_loss=119.6576 | val_loss=121.9830 | rel_l2=0.3154 | best=0.3152 | lr=2.88e-04 | pat=12/150 | 283s
  Epoch  136/1000 | train_loss=119.5933 | val_loss=122.0044 | rel_l2=0.3130 | best=0.3130 | lr=2.88e-04 | pat=0/150 | 285s
  Epoch  137/1000 | train_loss=119.3043 | val_loss=122.2134 | rel_l2=0.3148 | best=0.3130 | lr=2.88e-04 | pat=1/150 | 287s
  Epoch  138/1000 | train_loss=119.2548 | val_loss=122.6938 | rel_l2=0.3154 | best=0.3130 | lr=2.88e-04 | pat=2/150 | 289s
  Epoch  139/1000 | train_loss=119.2261 | val_loss=122.7071 | rel_l2=0.3166 | best=0.3130 | lr=2.88e-04 | pat=3/150 | 291s
  Epoch  140/1000 | train_loss=119.2821 | val_loss=122.1583 | rel_l2=0.3172 | best=0.3130 | lr=2.87e-04 | pat=4/150 | 293s
  Epoch  141/1000 | train_loss=119.2921 | val_loss=121.3761 | rel_l2=0.3148 | best=0.3130 | lr=2.87e-04 | pat=5/150 | 296s
  Epoch  142/1000 | train_loss=119.0079 | val_loss=122.9313 | rel_l2=0.3173 | best=0.3130 | lr=2.87e-04 | pat=6/150 | 298s
  Epoch  143/1000 | train_loss=119.0686 | val_loss=120.6078 | rel_l2=0.3148 | best=0.3130 | lr=2.87e-04 | pat=7/150 | 300s
  Epoch  144/1000 | train_loss=118.8444 | val_loss=122.8360 | rel_l2=0.3253 | best=0.3130 | lr=2.87e-04 | pat=8/150 | 302s
  Epoch  145/1000 | train_loss=118.9475 | val_loss=123.7639 | rel_l2=0.3244 | best=0.3130 | lr=2.86e-04 | pat=9/150 | 304s
  Epoch  146/1000 | train_loss=118.8545 | val_loss=123.4602 | rel_l2=0.3167 | best=0.3130 | lr=2.86e-04 | pat=10/150 | 306s
  Epoch  147/1000 | train_loss=118.8198 | val_loss=123.7085 | rel_l2=0.3239 | best=0.3130 | lr=2.86e-04 | pat=11/150 | 309s
  Epoch  148/1000 | train_loss=118.8746 | val_loss=122.8915 | rel_l2=0.3171 | best=0.3130 | lr=2.86e-04 | pat=12/150 | 311s
  Epoch  149/1000 | train_loss=118.4906 | val_loss=121.4712 | rel_l2=0.3177 | best=0.3130 | lr=2.86e-04 | pat=13/150 | 313s
  Epoch  150/1000 | train_loss=118.5522 | val_loss=121.6633 | rel_l2=0.3181 | best=0.3130 | lr=2.85e-04 | pat=14/150 | 315s
  Epoch  151/1000 | train_loss=118.8765 | val_loss=122.2140 | rel_l2=0.3175 | best=0.3130 | lr=2.85e-04 | pat=15/150 | 317s
  Epoch  152/1000 | train_loss=118.4498 | val_loss=123.8554 | rel_l2=0.3259 | best=0.3130 | lr=2.85e-04 | pat=16/150 | 319s
  Epoch  153/1000 | train_loss=118.6046 | val_loss=120.4143 | rel_l2=0.3157 | best=0.3130 | lr=2.85e-04 | pat=17/150 | 321s
  Epoch  154/1000 | train_loss=118.2857 | val_loss=121.8397 | rel_l2=0.3136 | best=0.3130 | lr=2.85e-04 | pat=18/150 | 323s
  Epoch  155/1000 | train_loss=118.3238 | val_loss=121.4017 | rel_l2=0.3154 | best=0.3130 | lr=2.84e-04 | pat=19/150 | 325s
  Epoch  156/1000 | train_loss=118.2456 | val_loss=121.8500 | rel_l2=0.3145 | best=0.3130 | lr=2.84e-04 | pat=20/150 | 327s
  Epoch  157/1000 | train_loss=118.2006 | val_loss=122.5113 | rel_l2=0.3155 | best=0.3130 | lr=2.84e-04 | pat=21/150 | 330s
  Epoch  158/1000 | train_loss=118.4643 | val_loss=122.5712 | rel_l2=0.3168 | best=0.3130 | lr=2.84e-04 | pat=22/150 | 332s
  Epoch  159/1000 | train_loss=118.3975 | val_loss=122.6281 | rel_l2=0.3148 | best=0.3130 | lr=2.84e-04 | pat=23/150 | 334s
  Epoch  160/1000 | train_loss=118.2647 | val_loss=121.6766 | rel_l2=0.3129 | best=0.3129 | lr=2.83e-04 | pat=0/150 | 336s
  Epoch  161/1000 | train_loss=117.9110 | val_loss=120.6682 | rel_l2=0.3129 | best=0.3129 | lr=2.83e-04 | pat=1/150 | 338s
  Epoch  162/1000 | train_loss=117.9226 | val_loss=121.5678 | rel_l2=0.3161 | best=0.3129 | lr=2.83e-04 | pat=2/150 | 340s
  Epoch  163/1000 | train_loss=117.9821 | val_loss=121.6405 | rel_l2=0.3127 | best=0.3127 | lr=2.83e-04 | pat=0/150 | 342s
  Epoch  164/1000 | train_loss=117.8940 | val_loss=121.4584 | rel_l2=0.3151 | best=0.3127 | lr=2.82e-04 | pat=1/150 | 344s
  Epoch  165/1000 | train_loss=117.8812 | val_loss=122.4689 | rel_l2=0.3130 | best=0.3127 | lr=2.82e-04 | pat=2/150 | 347s
  Epoch  166/1000 | train_loss=117.6200 | val_loss=122.0781 | rel_l2=0.3115 | best=0.3115 | lr=2.82e-04 | pat=0/150 | 349s
  Epoch  167/1000 | train_loss=117.6773 | val_loss=121.0518 | rel_l2=0.3208 | best=0.3115 | lr=2.82e-04 | pat=1/150 | 351s
  Epoch  168/1000 | train_loss=117.6570 | val_loss=119.9004 | rel_l2=0.3105 | best=0.3105 | lr=2.82e-04 | pat=0/150 | 353s
  Epoch  169/1000 | train_loss=117.7508 | val_loss=121.6713 | rel_l2=0.3167 | best=0.3105 | lr=2.81e-04 | pat=1/150 | 355s
  Epoch  170/1000 | train_loss=117.6443 | val_loss=120.0295 | rel_l2=0.3136 | best=0.3105 | lr=2.81e-04 | pat=2/150 | 357s
  Epoch  171/1000 | train_loss=117.7587 | val_loss=121.5753 | rel_l2=0.3135 | best=0.3105 | lr=2.81e-04 | pat=3/150 | 359s
  Epoch  172/1000 | train_loss=117.6206 | val_loss=121.6881 | rel_l2=0.3170 | best=0.3105 | lr=2.81e-04 | pat=4/150 | 361s
  Epoch  173/1000 | train_loss=117.3434 | val_loss=121.4687 | rel_l2=0.3173 | best=0.3105 | lr=2.80e-04 | pat=5/150 | 363s
  Epoch  174/1000 | train_loss=117.6673 | val_loss=124.3070 | rel_l2=0.3143 | best=0.3105 | lr=2.80e-04 | pat=6/150 | 365s
  Epoch  175/1000 | train_loss=117.4302 | val_loss=121.4734 | rel_l2=0.3149 | best=0.3105 | lr=2.80e-04 | pat=7/150 | 367s
  Epoch  176/1000 | train_loss=117.4591 | val_loss=122.5296 | rel_l2=0.3150 | best=0.3105 | lr=2.80e-04 | pat=8/150 | 369s
  Epoch  177/1000 | train_loss=117.2785 | val_loss=120.3026 | rel_l2=0.3123 | best=0.3105 | lr=2.79e-04 | pat=9/150 | 371s
  Epoch  178/1000 | train_loss=117.3041 | val_loss=121.3534 | rel_l2=0.3143 | best=0.3105 | lr=2.79e-04 | pat=10/150 | 373s
  Epoch  179/1000 | train_loss=117.2469 | val_loss=122.6278 | rel_l2=0.3150 | best=0.3105 | lr=2.79e-04 | pat=11/150 | 375s
  Epoch  180/1000 | train_loss=117.2067 | val_loss=125.5940 | rel_l2=0.3150 | best=0.3105 | lr=2.79e-04 | pat=12/150 | 377s
  Epoch  181/1000 | train_loss=117.4177 | val_loss=122.9860 | rel_l2=0.3155 | best=0.3105 | lr=2.78e-04 | pat=13/150 | 379s
  Epoch  182/1000 | train_loss=117.2304 | val_loss=120.8567 | rel_l2=0.3124 | best=0.3105 | lr=2.78e-04 | pat=14/150 | 382s
  Epoch  183/1000 | train_loss=117.2262 | val_loss=121.5515 | rel_l2=0.3137 | best=0.3105 | lr=2.78e-04 | pat=15/150 | 384s
  Epoch  184/1000 | train_loss=116.9307 | val_loss=120.8421 | rel_l2=0.3130 | best=0.3105 | lr=2.78e-04 | pat=16/150 | 386s
  Epoch  185/1000 | train_loss=116.7507 | val_loss=120.3345 | rel_l2=0.3123 | best=0.3105 | lr=2.77e-04 | pat=17/150 | 388s
  Epoch  186/1000 | train_loss=116.9018 | val_loss=123.1849 | rel_l2=0.3206 | best=0.3105 | lr=2.77e-04 | pat=18/150 | 390s
  Epoch  187/1000 | train_loss=117.0997 | val_loss=121.2783 | rel_l2=0.3147 | best=0.3105 | lr=2.77e-04 | pat=19/150 | 392s
  Epoch  188/1000 | train_loss=116.9906 | val_loss=121.0770 | rel_l2=0.3160 | best=0.3105 | lr=2.77e-04 | pat=20/150 | 394s
  Epoch  189/1000 | train_loss=116.7974 | val_loss=121.5170 | rel_l2=0.3143 | best=0.3105 | lr=2.76e-04 | pat=21/150 | 396s
  Epoch  190/1000 | train_loss=116.8973 | val_loss=121.4625 | rel_l2=0.3145 | best=0.3105 | lr=2.76e-04 | pat=22/150 | 398s
  Epoch  191/1000 | train_loss=116.8207 | val_loss=122.2597 | rel_l2=0.3175 | best=0.3105 | lr=2.76e-04 | pat=23/150 | 400s
  Epoch  192/1000 | train_loss=116.8537 | val_loss=121.4188 | rel_l2=0.3206 | best=0.3105 | lr=2.76e-04 | pat=24/150 | 402s
  Epoch  193/1000 | train_loss=116.8262 | val_loss=122.3818 | rel_l2=0.3140 | best=0.3105 | lr=2.75e-04 | pat=25/150 | 404s
  Epoch  194/1000 | train_loss=116.6264 | val_loss=121.5089 | rel_l2=0.3151 | best=0.3105 | lr=2.75e-04 | pat=26/150 | 406s
  Epoch  195/1000 | train_loss=116.5071 | val_loss=121.1889 | rel_l2=0.3131 | best=0.3105 | lr=2.75e-04 | pat=27/150 | 408s
  Epoch  196/1000 | train_loss=116.4679 | val_loss=121.9746 | rel_l2=0.3146 | best=0.3105 | lr=2.75e-04 | pat=28/150 | 410s
  Epoch  197/1000 | train_loss=116.3883 | val_loss=122.2650 | rel_l2=0.3241 | best=0.3105 | lr=2.74e-04 | pat=29/150 | 412s
  Epoch  198/1000 | train_loss=116.2697 | val_loss=122.2405 | rel_l2=0.3209 | best=0.3105 | lr=2.74e-04 | pat=30/150 | 414s
  Epoch  199/1000 | train_loss=116.4034 | val_loss=121.8265 | rel_l2=0.3191 | best=0.3105 | lr=2.74e-04 | pat=31/150 | 416s
  Epoch  200/1000 | train_loss=116.4752 | val_loss=121.0813 | rel_l2=0.3200 | best=0.3105 | lr=2.74e-04 | pat=32/150 | 418s
  Epoch  201/1000 | train_loss=116.2652 | val_loss=121.5537 | rel_l2=0.3150 | best=0.3105 | lr=2.73e-04 | pat=33/150 | 420s
  Epoch  202/1000 | train_loss=116.1304 | val_loss=121.0253 | rel_l2=0.3120 | best=0.3105 | lr=2.73e-04 | pat=34/150 | 422s
  Epoch  203/1000 | train_loss=116.0098 | val_loss=120.7396 | rel_l2=0.3196 | best=0.3105 | lr=2.73e-04 | pat=35/150 | 424s
  Epoch  204/1000 | train_loss=116.2511 | val_loss=122.0842 | rel_l2=0.3127 | best=0.3105 | lr=2.72e-04 | pat=36/150 | 427s
  Epoch  205/1000 | train_loss=116.0323 | val_loss=121.4806 | rel_l2=0.3138 | best=0.3105 | lr=2.72e-04 | pat=37/150 | 429s
  Epoch  206/1000 | train_loss=116.0679 | val_loss=122.0760 | rel_l2=0.3169 | best=0.3105 | lr=2.72e-04 | pat=38/150 | 431s
  Epoch  207/1000 | train_loss=116.0946 | val_loss=121.7741 | rel_l2=0.3198 | best=0.3105 | lr=2.72e-04 | pat=39/150 | 433s
  Epoch  208/1000 | train_loss=116.2039 | val_loss=121.4551 | rel_l2=0.3123 | best=0.3105 | lr=2.71e-04 | pat=40/150 | 435s
  Epoch  209/1000 | train_loss=115.9500 | val_loss=120.2931 | rel_l2=0.3143 | best=0.3105 | lr=2.71e-04 | pat=41/150 | 437s
  Epoch  210/1000 | train_loss=115.8279 | val_loss=122.2563 | rel_l2=0.3126 | best=0.3105 | lr=2.71e-04 | pat=42/150 | 439s
  Epoch  211/1000 | train_loss=116.1062 | val_loss=120.8517 | rel_l2=0.3175 | best=0.3105 | lr=2.71e-04 | pat=43/150 | 441s
  Epoch  212/1000 | train_loss=115.9406 | val_loss=121.4464 | rel_l2=0.3209 | best=0.3105 | lr=2.70e-04 | pat=44/150 | 443s
  Epoch  213/1000 | train_loss=115.6752 | val_loss=120.6667 | rel_l2=0.3144 | best=0.3105 | lr=2.70e-04 | pat=45/150 | 445s
  Epoch  214/1000 | train_loss=115.7147 | val_loss=120.8304 | rel_l2=0.3145 | best=0.3105 | lr=2.70e-04 | pat=46/150 | 447s
  Epoch  215/1000 | train_loss=115.8146 | val_loss=121.7370 | rel_l2=0.3162 | best=0.3105 | lr=2.69e-04 | pat=47/150 | 449s
  Epoch  216/1000 | train_loss=115.8269 | val_loss=121.5708 | rel_l2=0.3232 | best=0.3105 | lr=2.69e-04 | pat=48/150 | 451s
  Epoch  217/1000 | train_loss=115.8522 | val_loss=122.6703 | rel_l2=0.3152 | best=0.3105 | lr=2.69e-04 | pat=49/150 | 453s
  Epoch  218/1000 | train_loss=115.8195 | val_loss=122.8723 | rel_l2=0.3137 | best=0.3105 | lr=2.68e-04 | pat=50/150 | 455s
  Epoch  219/1000 | train_loss=115.8235 | val_loss=121.8179 | rel_l2=0.3158 | best=0.3105 | lr=2.68e-04 | pat=51/150 | 457s
  Epoch  220/1000 | train_loss=115.5845 | val_loss=120.0030 | rel_l2=0.3105 | best=0.3105 | lr=2.68e-04 | pat=0/150 | 459s
  Epoch  221/1000 | train_loss=115.6089 | val_loss=120.7938 | rel_l2=0.3141 | best=0.3105 | lr=2.68e-04 | pat=1/150 | 461s
  Epoch  222/1000 | train_loss=115.6046 | val_loss=119.8601 | rel_l2=0.3140 | best=0.3105 | lr=2.67e-04 | pat=2/150 | 463s
  Epoch  223/1000 | train_loss=115.4663 | val_loss=120.9434 | rel_l2=0.3145 | best=0.3105 | lr=2.67e-04 | pat=3/150 | 465s
  Epoch  224/1000 | train_loss=115.4824 | val_loss=120.3363 | rel_l2=0.3171 | best=0.3105 | lr=2.67e-04 | pat=4/150 | 467s
  Epoch  225/1000 | train_loss=115.4103 | val_loss=122.0260 | rel_l2=0.3277 | best=0.3105 | lr=2.66e-04 | pat=5/150 | 469s
  Epoch  226/1000 | train_loss=115.5570 | val_loss=120.3412 | rel_l2=0.3140 | best=0.3105 | lr=2.66e-04 | pat=6/150 | 471s
  Epoch  227/1000 | train_loss=115.5741 | val_loss=119.6322 | rel_l2=0.3127 | best=0.3105 | lr=2.66e-04 | pat=7/150 | 473s
  Epoch  228/1000 | train_loss=115.2806 | val_loss=121.0188 | rel_l2=0.3156 | best=0.3105 | lr=2.66e-04 | pat=8/150 | 475s
  Epoch  229/1000 | train_loss=115.1656 | val_loss=120.8273 | rel_l2=0.3120 | best=0.3105 | lr=2.65e-04 | pat=9/150 | 477s
  Epoch  230/1000 | train_loss=115.4135 | val_loss=121.0718 | rel_l2=0.3209 | best=0.3105 | lr=2.65e-04 | pat=10/150 | 479s
  Epoch  231/1000 | train_loss=115.1858 | val_loss=123.5616 | rel_l2=0.3131 | best=0.3105 | lr=2.65e-04 | pat=11/150 | 482s
  Epoch  232/1000 | train_loss=115.3938 | val_loss=120.3909 | rel_l2=0.3131 | best=0.3105 | lr=2.64e-04 | pat=12/150 | 484s
  Epoch  233/1000 | train_loss=115.2764 | val_loss=120.8740 | rel_l2=0.3129 | best=0.3105 | lr=2.64e-04 | pat=13/150 | 486s
  Epoch  234/1000 | train_loss=114.9886 | val_loss=120.1931 | rel_l2=0.3096 | best=0.3096 | lr=2.64e-04 | pat=0/150 | 488s
  Epoch  235/1000 | train_loss=115.1396 | val_loss=119.0320 | rel_l2=0.3120 | best=0.3096 | lr=2.63e-04 | pat=1/150 | 490s
  Epoch  236/1000 | train_loss=114.9893 | val_loss=119.6807 | rel_l2=0.3112 | best=0.3096 | lr=2.63e-04 | pat=2/150 | 492s
  Epoch  237/1000 | train_loss=115.2094 | val_loss=120.5803 | rel_l2=0.3106 | best=0.3096 | lr=2.63e-04 | pat=3/150 | 494s
  Epoch  238/1000 | train_loss=114.8864 | val_loss=120.7052 | rel_l2=0.3123 | best=0.3096 | lr=2.62e-04 | pat=4/150 | 496s
  Epoch  239/1000 | train_loss=114.9684 | val_loss=120.8475 | rel_l2=0.3211 | best=0.3096 | lr=2.62e-04 | pat=5/150 | 498s
  Epoch  240/1000 | train_loss=114.9490 | val_loss=120.2487 | rel_l2=0.3152 | best=0.3096 | lr=2.62e-04 | pat=6/150 | 500s
  Epoch  241/1000 | train_loss=114.8216 | val_loss=121.9794 | rel_l2=0.3159 | best=0.3096 | lr=2.61e-04 | pat=7/150 | 502s
  Epoch  242/1000 | train_loss=114.8491 | val_loss=120.4916 | rel_l2=0.3149 | best=0.3096 | lr=2.61e-04 | pat=8/150 | 504s
  Epoch  243/1000 | train_loss=114.7452 | val_loss=119.6596 | rel_l2=0.3149 | best=0.3096 | lr=2.61e-04 | pat=9/150 | 506s
  Epoch  244/1000 | train_loss=114.6195 | val_loss=124.4709 | rel_l2=0.3150 | best=0.3096 | lr=2.61e-04 | pat=10/150 | 508s
  Epoch  245/1000 | train_loss=114.9656 | val_loss=121.1526 | rel_l2=0.3189 | best=0.3096 | lr=2.60e-04 | pat=11/150 | 510s
  Epoch  246/1000 | train_loss=114.5853 | val_loss=119.9216 | rel_l2=0.3108 | best=0.3096 | lr=2.60e-04 | pat=12/150 | 512s
  Epoch  247/1000 | train_loss=114.5390 | val_loss=120.0551 | rel_l2=0.3122 | best=0.3096 | lr=2.60e-04 | pat=13/150 | 514s
  Epoch  248/1000 | train_loss=114.6155 | val_loss=121.1851 | rel_l2=0.3145 | best=0.3096 | lr=2.59e-04 | pat=14/150 | 517s
  Epoch  249/1000 | train_loss=114.6083 | val_loss=121.0322 | rel_l2=0.3162 | best=0.3096 | lr=2.59e-04 | pat=15/150 | 519s
  Epoch  250/1000 | train_loss=114.6329 | val_loss=121.7756 | rel_l2=0.3187 | best=0.3096 | lr=2.59e-04 | pat=16/150 | 521s
  Epoch  251/1000 | train_loss=114.4562 | val_loss=119.6207 | rel_l2=0.3141 | best=0.3096 | lr=2.58e-04 | pat=17/150 | 523s
  Epoch  252/1000 | train_loss=114.3817 | val_loss=119.3495 | rel_l2=0.3125 | best=0.3096 | lr=2.58e-04 | pat=18/150 | 525s
  Epoch  253/1000 | train_loss=114.6108 | val_loss=120.7372 | rel_l2=0.3136 | best=0.3096 | lr=2.58e-04 | pat=19/150 | 527s
  Epoch  254/1000 | train_loss=114.6163 | val_loss=122.8681 | rel_l2=0.3168 | best=0.3096 | lr=2.57e-04 | pat=20/150 | 529s
  Epoch  255/1000 | train_loss=114.4452 | val_loss=122.6868 | rel_l2=0.3147 | best=0.3096 | lr=2.57e-04 | pat=21/150 | 531s
  Epoch  256/1000 | train_loss=114.3696 | val_loss=120.8532 | rel_l2=0.3119 | best=0.3096 | lr=2.57e-04 | pat=22/150 | 533s
  Epoch  257/1000 | train_loss=114.2827 | val_loss=120.5665 | rel_l2=0.3142 | best=0.3096 | lr=2.56e-04 | pat=23/150 | 535s
  Epoch  258/1000 | train_loss=114.1839 | val_loss=121.6496 | rel_l2=0.3116 | best=0.3096 | lr=2.56e-04 | pat=24/150 | 537s
  Epoch  259/1000 | train_loss=114.2962 | val_loss=119.9780 | rel_l2=0.3105 | best=0.3096 | lr=2.56e-04 | pat=25/150 | 539s
  Epoch  260/1000 | train_loss=114.3180 | val_loss=121.6595 | rel_l2=0.3120 | best=0.3096 | lr=2.55e-04 | pat=26/150 | 541s
  Epoch  261/1000 | train_loss=114.2539 | val_loss=119.2114 | rel_l2=0.3151 | best=0.3096 | lr=2.55e-04 | pat=27/150 | 543s
  Epoch  262/1000 | train_loss=114.1720 | val_loss=120.9481 | rel_l2=0.3122 | best=0.3096 | lr=2.55e-04 | pat=28/150 | 545s
  Epoch  263/1000 | train_loss=114.1587 | val_loss=121.6811 | rel_l2=0.3117 | best=0.3096 | lr=2.54e-04 | pat=29/150 | 547s
  Epoch  264/1000 | train_loss=114.2099 | val_loss=119.8113 | rel_l2=0.3119 | best=0.3096 | lr=2.54e-04 | pat=30/150 | 549s
  Epoch  265/1000 | train_loss=114.1494 | val_loss=122.9890 | rel_l2=0.3104 | best=0.3096 | lr=2.54e-04 | pat=31/150 | 551s
  Epoch  266/1000 | train_loss=114.1135 | val_loss=120.4078 | rel_l2=0.3102 | best=0.3096 | lr=2.53e-04 | pat=32/150 | 553s
  Epoch  267/1000 | train_loss=114.0750 | val_loss=120.1187 | rel_l2=0.3135 | best=0.3096 | lr=2.53e-04 | pat=33/150 | 555s
  Epoch  268/1000 | train_loss=113.9159 | val_loss=120.9284 | rel_l2=0.3144 | best=0.3096 | lr=2.52e-04 | pat=34/150 | 557s
  Epoch  269/1000 | train_loss=114.0579 | val_loss=119.7677 | rel_l2=0.3119 | best=0.3096 | lr=2.52e-04 | pat=35/150 | 559s
  Epoch  270/1000 | train_loss=113.9002 | val_loss=121.5378 | rel_l2=0.3118 | best=0.3096 | lr=2.52e-04 | pat=36/150 | 561s
  Epoch  271/1000 | train_loss=114.0227 | val_loss=121.3644 | rel_l2=0.3134 | best=0.3096 | lr=2.51e-04 | pat=37/150 | 563s
  Epoch  272/1000 | train_loss=113.9575 | val_loss=121.5185 | rel_l2=0.3138 | best=0.3096 | lr=2.51e-04 | pat=38/150 | 565s
  Epoch  273/1000 | train_loss=114.0478 | val_loss=120.3066 | rel_l2=0.3114 | best=0.3096 | lr=2.51e-04 | pat=39/150 | 567s
  Epoch  274/1000 | train_loss=113.8485 | val_loss=121.2340 | rel_l2=0.3116 | best=0.3096 | lr=2.50e-04 | pat=40/150 | 569s
  Epoch  275/1000 | train_loss=114.0692 | val_loss=121.5391 | rel_l2=0.3139 | best=0.3096 | lr=2.50e-04 | pat=41/150 | 571s
  Epoch  276/1000 | train_loss=113.8008 | val_loss=120.1250 | rel_l2=0.3168 | best=0.3096 | lr=2.50e-04 | pat=42/150 | 573s
  Epoch  277/1000 | train_loss=113.9234 | val_loss=121.9380 | rel_l2=0.3238 | best=0.3096 | lr=2.49e-04 | pat=43/150 | 575s
  Epoch  278/1000 | train_loss=113.7671 | val_loss=120.9459 | rel_l2=0.3122 | best=0.3096 | lr=2.49e-04 | pat=44/150 | 577s
  Epoch  279/1000 | train_loss=113.6487 | val_loss=119.9946 | rel_l2=0.3127 | best=0.3096 | lr=2.49e-04 | pat=45/150 | 579s
  Epoch  280/1000 | train_loss=113.6713 | val_loss=120.1670 | rel_l2=0.3140 | best=0.3096 | lr=2.48e-04 | pat=46/150 | 581s
  Epoch  281/1000 | train_loss=113.5606 | val_loss=121.7488 | rel_l2=0.3174 | best=0.3096 | lr=2.48e-04 | pat=47/150 | 583s
  Epoch  282/1000 | train_loss=113.6083 | val_loss=119.2934 | rel_l2=0.3099 | best=0.3096 | lr=2.48e-04 | pat=48/150 | 585s
  Epoch  283/1000 | train_loss=113.5841 | val_loss=120.6588 | rel_l2=0.3112 | best=0.3096 | lr=2.47e-04 | pat=49/150 | 587s
  Epoch  284/1000 | train_loss=113.6184 | val_loss=122.1266 | rel_l2=0.3186 | best=0.3096 | lr=2.47e-04 | pat=50/150 | 589s
  Epoch  285/1000 | train_loss=113.4253 | val_loss=119.5328 | rel_l2=0.3136 | best=0.3096 | lr=2.46e-04 | pat=51/150 | 591s
  Epoch  286/1000 | train_loss=113.5679 | val_loss=121.3400 | rel_l2=0.3146 | best=0.3096 | lr=2.46e-04 | pat=52/150 | 593s
  Epoch  287/1000 | train_loss=113.6101 | val_loss=121.0863 | rel_l2=0.3228 | best=0.3096 | lr=2.46e-04 | pat=53/150 | 595s
  Epoch  288/1000 | train_loss=113.5231 | val_loss=119.8207 | rel_l2=0.3138 | best=0.3096 | lr=2.45e-04 | pat=54/150 | 597s
  Epoch  289/1000 | train_loss=113.3034 | val_loss=119.7723 | rel_l2=0.3109 | best=0.3096 | lr=2.45e-04 | pat=55/150 | 599s
  Epoch  290/1000 | train_loss=113.5925 | val_loss=119.4746 | rel_l2=0.3104 | best=0.3096 | lr=2.45e-04 | pat=56/150 | 601s
  Epoch  291/1000 | train_loss=113.5033 | val_loss=122.4816 | rel_l2=0.3196 | best=0.3096 | lr=2.44e-04 | pat=57/150 | 604s
  Epoch  292/1000 | train_loss=113.4171 | val_loss=119.8569 | rel_l2=0.3151 | best=0.3096 | lr=2.44e-04 | pat=58/150 | 606s
  Epoch  293/1000 | train_loss=113.4132 | val_loss=119.7860 | rel_l2=0.3125 | best=0.3096 | lr=2.43e-04 | pat=59/150 | 608s
  Epoch  294/1000 | train_loss=113.3877 | val_loss=119.3179 | rel_l2=0.3117 | best=0.3096 | lr=2.43e-04 | pat=60/150 | 610s
  Epoch  295/1000 | train_loss=113.3177 | val_loss=119.6469 | rel_l2=0.3108 | best=0.3096 | lr=2.43e-04 | pat=61/150 | 612s
  Epoch  296/1000 | train_loss=113.3745 | val_loss=118.7414 | rel_l2=0.3119 | best=0.3096 | lr=2.42e-04 | pat=62/150 | 614s
  Epoch  297/1000 | train_loss=113.3019 | val_loss=119.8372 | rel_l2=0.3116 | best=0.3096 | lr=2.42e-04 | pat=63/150 | 616s
  Epoch  298/1000 | train_loss=113.2994 | val_loss=119.2878 | rel_l2=0.3123 | best=0.3096 | lr=2.42e-04 | pat=64/150 | 618s
  Epoch  299/1000 | train_loss=113.0330 | val_loss=120.7882 | rel_l2=0.3135 | best=0.3096 | lr=2.41e-04 | pat=65/150 | 621s
  Epoch  300/1000 | train_loss=113.3363 | val_loss=120.1014 | rel_l2=0.3138 | best=0.3096 | lr=2.41e-04 | pat=66/150 | 623s
  Epoch  301/1000 | train_loss=113.2917 | val_loss=120.3685 | rel_l2=0.3123 | best=0.3096 | lr=2.40e-04 | pat=67/150 | 625s
  Epoch  302/1000 | train_loss=113.3429 | val_loss=120.5279 | rel_l2=0.3163 | best=0.3096 | lr=2.40e-04 | pat=68/150 | 627s
  Epoch  303/1000 | train_loss=113.0899 | val_loss=119.6218 | rel_l2=0.3140 | best=0.3096 | lr=2.40e-04 | pat=69/150 | 629s
  Epoch  304/1000 | train_loss=113.0623 | val_loss=119.8200 | rel_l2=0.3154 | best=0.3096 | lr=2.39e-04 | pat=70/150 | 631s
  Epoch  305/1000 | train_loss=112.7617 | val_loss=121.1129 | rel_l2=0.3125 | best=0.3096 | lr=2.39e-04 | pat=71/150 | 634s
  Epoch  306/1000 | train_loss=112.8793 | val_loss=120.2453 | rel_l2=0.3110 | best=0.3096 | lr=2.39e-04 | pat=72/150 | 636s
  Epoch  307/1000 | train_loss=113.0271 | val_loss=121.0720 | rel_l2=0.3143 | best=0.3096 | lr=2.38e-04 | pat=73/150 | 638s
  Epoch  308/1000 | train_loss=112.8105 | val_loss=121.0215 | rel_l2=0.3145 | best=0.3096 | lr=2.38e-04 | pat=74/150 | 640s
  Epoch  309/1000 | train_loss=113.1057 | val_loss=119.2649 | rel_l2=0.3166 | best=0.3096 | lr=2.37e-04 | pat=75/150 | 642s
  Epoch  310/1000 | train_loss=112.9128 | val_loss=120.5680 | rel_l2=0.3183 | best=0.3096 | lr=2.37e-04 | pat=76/150 | 644s
  Epoch  311/1000 | train_loss=112.9990 | val_loss=119.5820 | rel_l2=0.3123 | best=0.3096 | lr=2.37e-04 | pat=77/150 | 646s
  Epoch  312/1000 | train_loss=112.8937 | val_loss=121.5853 | rel_l2=0.3223 | best=0.3096 | lr=2.36e-04 | pat=78/150 | 648s
  Epoch  313/1000 | train_loss=112.8034 | val_loss=120.6109 | rel_l2=0.3131 | best=0.3096 | lr=2.36e-04 | pat=79/150 | 650s
  Epoch  314/1000 | train_loss=112.7206 | val_loss=120.7600 | rel_l2=0.3187 | best=0.3096 | lr=2.35e-04 | pat=80/150 | 653s
  Epoch  315/1000 | train_loss=112.7675 | val_loss=121.0697 | rel_l2=0.3151 | best=0.3096 | lr=2.35e-04 | pat=81/150 | 655s
  Epoch  316/1000 | train_loss=112.6738 | val_loss=120.1516 | rel_l2=0.3116 | best=0.3096 | lr=2.35e-04 | pat=82/150 | 657s
  Epoch  317/1000 | train_loss=112.6162 | val_loss=119.8885 | rel_l2=0.3156 | best=0.3096 | lr=2.34e-04 | pat=83/150 | 659s
  Epoch  318/1000 | train_loss=112.9721 | val_loss=121.5509 | rel_l2=0.3157 | best=0.3096 | lr=2.34e-04 | pat=84/150 | 661s
  Epoch  319/1000 | train_loss=112.5883 | val_loss=120.7777 | rel_l2=0.3152 | best=0.3096 | lr=2.33e-04 | pat=85/150 | 663s
  Epoch  320/1000 | train_loss=112.4675 | val_loss=121.0812 | rel_l2=0.3177 | best=0.3096 | lr=2.33e-04 | pat=86/150 | 665s
  Epoch  321/1000 | train_loss=112.6679 | val_loss=120.5971 | rel_l2=0.3120 | best=0.3096 | lr=2.33e-04 | pat=87/150 | 667s
  Epoch  322/1000 | train_loss=112.6926 | val_loss=120.2890 | rel_l2=0.3187 | best=0.3096 | lr=2.32e-04 | pat=88/150 | 670s
  Epoch  323/1000 | train_loss=112.5851 | val_loss=120.0580 | rel_l2=0.3145 | best=0.3096 | lr=2.32e-04 | pat=89/150 | 672s
  Epoch  324/1000 | train_loss=112.5420 | val_loss=120.2310 | rel_l2=0.3137 | best=0.3096 | lr=2.31e-04 | pat=90/150 | 674s
  Epoch  325/1000 | train_loss=112.6447 | val_loss=120.2838 | rel_l2=0.3131 | best=0.3096 | lr=2.31e-04 | pat=91/150 | 676s
  Epoch  326/1000 | train_loss=112.4883 | val_loss=121.3583 | rel_l2=0.3143 | best=0.3096 | lr=2.31e-04 | pat=92/150 | 678s
  Epoch  327/1000 | train_loss=112.5133 | val_loss=121.3677 | rel_l2=0.3174 | best=0.3096 | lr=2.30e-04 | pat=93/150 | 680s
  Epoch  328/1000 | train_loss=112.5160 | val_loss=120.6428 | rel_l2=0.3154 | best=0.3096 | lr=2.30e-04 | pat=94/150 | 682s
  Epoch  329/1000 | train_loss=112.3912 | val_loss=120.1148 | rel_l2=0.3131 | best=0.3096 | lr=2.29e-04 | pat=95/150 | 684s
  Epoch  330/1000 | train_loss=112.2819 | val_loss=120.1967 | rel_l2=0.3126 | best=0.3096 | lr=2.29e-04 | pat=96/150 | 687s
  Epoch  331/1000 | train_loss=112.4029 | val_loss=119.5023 | rel_l2=0.3131 | best=0.3096 | lr=2.29e-04 | pat=97/150 | 689s
  Epoch  332/1000 | train_loss=112.3143 | val_loss=120.8464 | rel_l2=0.3135 | best=0.3096 | lr=2.28e-04 | pat=98/150 | 691s
  Epoch  333/1000 | train_loss=112.3977 | val_loss=119.8900 | rel_l2=0.3140 | best=0.3096 | lr=2.28e-04 | pat=99/150 | 693s
  Epoch  334/1000 | train_loss=112.2757 | val_loss=119.3627 | rel_l2=0.3123 | best=0.3096 | lr=2.27e-04 | pat=100/150 | 695s
  Epoch  335/1000 | train_loss=112.2611 | val_loss=121.0147 | rel_l2=0.3150 | best=0.3096 | lr=2.27e-04 | pat=101/150 | 698s
  Epoch  336/1000 | train_loss=112.4323 | val_loss=121.0901 | rel_l2=0.3156 | best=0.3096 | lr=2.27e-04 | pat=102/150 | 700s
  Epoch  337/1000 | train_loss=112.1648 | val_loss=120.2985 | rel_l2=0.3143 | best=0.3096 | lr=2.26e-04 | pat=103/150 | 702s
  Epoch  338/1000 | train_loss=112.1462 | val_loss=120.5538 | rel_l2=0.3145 | best=0.3096 | lr=2.26e-04 | pat=104/150 | 704s
  Epoch  339/1000 | train_loss=112.3377 | val_loss=121.7051 | rel_l2=0.3137 | best=0.3096 | lr=2.25e-04 | pat=105/150 | 706s
  Epoch  340/1000 | train_loss=112.1922 | val_loss=118.7198 | rel_l2=0.3115 | best=0.3096 | lr=2.25e-04 | pat=106/150 | 708s
  Epoch  341/1000 | train_loss=112.0233 | val_loss=121.3130 | rel_l2=0.3132 | best=0.3096 | lr=2.25e-04 | pat=107/150 | 710s
  Epoch  342/1000 | train_loss=112.2385 | val_loss=120.1674 | rel_l2=0.3122 | best=0.3096 | lr=2.24e-04 | pat=108/150 | 712s
  Epoch  343/1000 | train_loss=112.5864 | val_loss=121.4777 | rel_l2=0.3179 | best=0.3096 | lr=2.24e-04 | pat=109/150 | 715s
  Epoch  344/1000 | train_loss=112.1848 | val_loss=120.0330 | rel_l2=0.3123 | best=0.3096 | lr=2.23e-04 | pat=110/150 | 717s
  Epoch  345/1000 | train_loss=112.1062 | val_loss=119.3167 | rel_l2=0.3130 | best=0.3096 | lr=2.23e-04 | pat=111/150 | 719s
  Epoch  346/1000 | train_loss=111.9625 | val_loss=119.7562 | rel_l2=0.3135 | best=0.3096 | lr=2.23e-04 | pat=112/150 | 721s
  Epoch  347/1000 | train_loss=112.0086 | val_loss=120.1868 | rel_l2=0.3141 | best=0.3096 | lr=2.22e-04 | pat=113/150 | 723s
  Epoch  348/1000 | train_loss=112.1740 | val_loss=124.4542 | rel_l2=0.3172 | best=0.3096 | lr=2.22e-04 | pat=114/150 | 725s
  Epoch  349/1000 | train_loss=112.0061 | val_loss=121.2831 | rel_l2=0.3193 | best=0.3096 | lr=2.21e-04 | pat=115/150 | 727s
  Epoch  350/1000 | train_loss=111.9129 | val_loss=120.1130 | rel_l2=0.3169 | best=0.3096 | lr=2.21e-04 | pat=116/150 | 729s
  Epoch  351/1000 | train_loss=111.8595 | val_loss=121.4511 | rel_l2=0.3185 | best=0.3096 | lr=2.20e-04 | pat=117/150 | 731s
  Epoch  352/1000 | train_loss=111.8904 | val_loss=118.8977 | rel_l2=0.3137 | best=0.3096 | lr=2.20e-04 | pat=118/150 | 733s
  Epoch  353/1000 | train_loss=111.8166 | val_loss=119.7488 | rel_l2=0.3145 | best=0.3096 | lr=2.20e-04 | pat=119/150 | 735s
  Epoch  354/1000 | train_loss=112.0726 | val_loss=119.8258 | rel_l2=0.3133 | best=0.3096 | lr=2.19e-04 | pat=120/150 | 737s
  Epoch  355/1000 | train_loss=111.7519 | val_loss=120.8699 | rel_l2=0.3192 | best=0.3096 | lr=2.19e-04 | pat=121/150 | 739s
  Epoch  356/1000 | train_loss=111.8149 | val_loss=119.6551 | rel_l2=0.3123 | best=0.3096 | lr=2.18e-04 | pat=122/150 | 741s
  Epoch  357/1000 | train_loss=111.8305 | val_loss=121.3923 | rel_l2=0.3184 | best=0.3096 | lr=2.18e-04 | pat=123/150 | 743s
  Epoch  358/1000 | train_loss=111.7525 | val_loss=120.9237 | rel_l2=0.3140 | best=0.3096 | lr=2.17e-04 | pat=124/150 | 745s
  Epoch  359/1000 | train_loss=111.7381 | val_loss=121.0279 | rel_l2=0.3185 | best=0.3096 | lr=2.17e-04 | pat=125/150 | 747s
  Epoch  360/1000 | train_loss=111.8190 | val_loss=120.6593 | rel_l2=0.3167 | best=0.3096 | lr=2.17e-04 | pat=126/150 | 750s
  Epoch  361/1000 | train_loss=111.6614 | val_loss=120.8460 | rel_l2=0.3201 | best=0.3096 | lr=2.16e-04 | pat=127/150 | 752s
  Epoch  362/1000 | train_loss=111.7581 | val_loss=119.9353 | rel_l2=0.3142 | best=0.3096 | lr=2.16e-04 | pat=128/150 | 754s
  Epoch  363/1000 | train_loss=111.6904 | val_loss=122.1905 | rel_l2=0.3149 | best=0.3096 | lr=2.15e-04 | pat=129/150 | 756s
  Epoch  364/1000 | train_loss=111.6644 | val_loss=120.1753 | rel_l2=0.3166 | best=0.3096 | lr=2.15e-04 | pat=130/150 | 758s
  Epoch  365/1000 | train_loss=111.7911 | val_loss=121.2851 | rel_l2=0.3192 | best=0.3096 | lr=2.14e-04 | pat=131/150 | 760s
  Epoch  366/1000 | train_loss=111.7821 | val_loss=120.7994 | rel_l2=0.3142 | best=0.3096 | lr=2.14e-04 | pat=132/150 | 762s
  Epoch  367/1000 | train_loss=111.6232 | val_loss=120.6926 | rel_l2=0.3114 | best=0.3096 | lr=2.14e-04 | pat=133/150 | 764s
  Epoch  368/1000 | train_loss=111.5099 | val_loss=120.0478 | rel_l2=0.3136 | best=0.3096 | lr=2.13e-04 | pat=134/150 | 766s
  Epoch  369/1000 | train_loss=111.5447 | val_loss=119.4996 | rel_l2=0.3140 | best=0.3096 | lr=2.13e-04 | pat=135/150 | 768s
  Epoch  370/1000 | train_loss=111.6155 | val_loss=120.0871 | rel_l2=0.3148 | best=0.3096 | lr=2.12e-04 | pat=136/150 | 770s
  Epoch  371/1000 | train_loss=111.6899 | val_loss=119.7184 | rel_l2=0.3148 | best=0.3096 | lr=2.12e-04 | pat=137/150 | 772s
  Epoch  372/1000 | train_loss=111.3530 | val_loss=119.9926 | rel_l2=0.3155 | best=0.3096 | lr=2.11e-04 | pat=138/150 | 774s
  Epoch  373/1000 | train_loss=111.4323 | val_loss=120.1466 | rel_l2=0.3124 | best=0.3096 | lr=2.11e-04 | pat=139/150 | 776s
  Epoch  374/1000 | train_loss=111.2670 | val_loss=119.9215 | rel_l2=0.3163 | best=0.3096 | lr=2.11e-04 | pat=140/150 | 778s
  Epoch  375/1000 | train_loss=111.7374 | val_loss=120.0329 | rel_l2=0.3147 | best=0.3096 | lr=2.10e-04 | pat=141/150 | 780s
  Epoch  376/1000 | train_loss=111.3160 | val_loss=119.8023 | rel_l2=0.3148 | best=0.3096 | lr=2.10e-04 | pat=142/150 | 783s
  Epoch  377/1000 | train_loss=111.4392 | val_loss=121.1456 | rel_l2=0.3206 | best=0.3096 | lr=2.09e-04 | pat=143/150 | 785s
  Epoch  378/1000 | train_loss=111.2812 | val_loss=120.9669 | rel_l2=0.3189 | best=0.3096 | lr=2.09e-04 | pat=144/150 | 787s
  Epoch  379/1000 | train_loss=111.3767 | val_loss=121.2396 | rel_l2=0.3130 | best=0.3096 | lr=2.08e-04 | pat=145/150 | 789s
  Epoch  380/1000 | train_loss=111.4262 | val_loss=121.0234 | rel_l2=0.3152 | best=0.3096 | lr=2.08e-04 | pat=146/150 | 791s
  Epoch  381/1000 | train_loss=111.3941 | val_loss=119.3389 | rel_l2=0.3143 | best=0.3096 | lr=2.08e-04 | pat=147/150 | 793s
  Epoch  382/1000 | train_loss=111.3233 | val_loss=120.2035 | rel_l2=0.3193 | best=0.3096 | lr=2.07e-04 | pat=148/150 | 795s
  Epoch  383/1000 | train_loss=111.2324 | val_loss=119.7921 | rel_l2=0.3147 | best=0.3096 | lr=2.07e-04 | pat=149/150 | 797s
  Epoch  384/1000 | train_loss=111.3362 | val_loss=120.7960 | rel_l2=0.3168 | best=0.3096 | lr=2.06e-04 | pat=150/150 | 799s
  Early stopping at epoch 384 (no improvement for 150 epochs)

Training complete in 800.7s
  val_relative_l2:   0.3185
  train_relative_l2: 0.3316

=== VERIFICATION GATE ===
  WARN: test_relative_l2 = 0.3426 >= 0.05
  FAIL: test_relative_l2 = 0.3426 >= 0.10 (hard fail)
  PASS: no severe overfitting (val/train = 1.08)
  WARN: chi_e relative_l2 = 0.4105 >= 0.10
  WARN: chi_i relative_l2 = 0.3172 >= 0.10
  WARN: D_e relative_l2 = 0.5610 >= 0.10
  PASS: all predictions finite and non-negative

  VERIFICATION FAILED — weights NOT saved.
  Try: --epochs 1000 --lr 1e-4 --hidden-dims 512,256
